<textarea hidden readonly name="{{ widget.name }}" id="id_{{ widget.name }}">
{% if widget.value %}{{ widget.value }}{% endif %}</textarea>
<div id="id_{{ widget.name }}_editor"></div>
<link href="https://cdn.bootcss.com/jsoneditor/5.27.1/jsoneditor.min.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/jsoneditor/5.27.1/jsoneditor.min.js"></script>
<script>

    // create the editor
    let container = document.getElementById("id_{{ widget.name }}_editor");
    let editor = new JSONEditor(container, {
        modes: ['tree', 'code',],
        language: 'zh_CN',
        languages: {
            zh_CN: {
                array: '数组',
                auto: '自动',
                appendText: '追加',
                appendTitle: '在此字段后追加一个类型为“auto”的新字段 (Ctrl+Shift+Ins)',
                appendSubmenuTitle: '选择要追加的字段类型',
                appendTitleAuto: '追加类型为“auto”的新字段 (Ctrl+Shift+Ins)',
                ascending: '升序',
                ascendingTitle: '升序排列${type}的子节点',
                actionsMenu: '点击打开动作菜单(Ctrl+M)',
                collapseAll: '缩进所有字段',
                descending: '姜旭',
                descendingTitle: '降序序排列${type}的子节点',
                drag: '拖拽移动该节点(Alt+Shift+Arrows)',
                duplicateKey: '复制键',
                duplicateText: '复制',
                duplicateTitle: '复制选中字段(Ctrl+D)',
                duplicateField: '复制该字段(Ctrl+D)',
                empty: '清空',
                expandAll: '展开所有字段',
                expandTitle: '点击 展开/收缩 该字段(Ctrl+E). \n' +
                    'Ctrl+Click 展开/收缩 包含所有子节点.',
                insert: '插入',
                insertTitle: '在此字段前插入类型为“auto”的新字段 (Ctrl+Ins)',
                insertSub: '选择要插入的字段类型',
                object: '对象',
                ok: 'Ok',
                redo: '重做 (Ctrl+Shift+Z)',
                removeText: '移除',
                removeTitle: '移除选中字段 (Ctrl+Del)',
                removeField: '移除该字段 (Ctrl+Del)',
                selectNode: '选择一个节点...',
                showAll: '展示全部',
                showMore: '展示更多',
                showMoreStatus: '显示${totalChilds}的${visibleChilds}项目.',
                sort: '排序',
                sortTitle: '排序${type}的子节点',
                sortTitleShort: '内容排序',
                sortFieldLabel: '字段：',
                sortDirectionLabel: '方向：',
                sortFieldTitle: '选择用于对数组或对象排序的嵌套字段',
                sortAscending: '升序排序',
                sortAscendingTitle: '按照该字段升序排序',
                sortDescending: '降序排序',
                sortDescendingTitle: '按照该字段降序排序',
                string: '字符串',
                transform: '变换',
                transformTitle: '筛选，排序，或者转换${type}的子节点',
                transformTitleShort: '筛选，排序，或者转换内容',
                transformQueryTitle: '输入JMESPath查询',
                transformWizardLabel: 'Wizard',
                transformWizardFilter: '筛选',
                transformWizardSortBy: '排序',
                transformWizardSelectFields: '选择字段',
                transformQueryLabel: '查询',
                transformPreviewLabel: '预览',
                type: '类型',
                typeTitle: '更改字段类型',
                openUrl: 'Ctrl+Click 或者 Ctrl+Enter 在新窗口打开链接',
                undo: '撤销上次动作 (Ctrl+Z)',
                validationCannotMove: '无法将字段移入其子节点',
                autoType: '字段类型 "auto". ' +
                    '字段类型由值自动确定 ' +
                    '可以为 string，number，boolean，或者 null.',
                objectType: '字段类型 "object". ' +
                    '对象包含一组无序的键/值对.',
                arrayType: '字段类型 "array". ' +
                    '数组包含值的有序集合.',
                stringType: '字段类型 "string". ' +
                    '字段类型由值自动确定，' +
                    '但始终作为字符串返回.',
                modeCodeText: '代码',
                modeCodeTitle: '切换至代码高亮',
                modeFormText: '表单',
                modeFormTitle: '切换至表单编辑',
                modeTextText: '文本',
                modeTextTitle: '切换至文本编辑',
                modeTreeText: '树',
                modeTreeTitle: '切换至树编辑',
                modeViewText: '视图',
                modeViewTitle: '切换至树视图',
            }
        },
        onChange: () => {
            let textarea = document.getElementById('id_{{ widget.name }}');
            textarea.value = JSON.stringify(editor.get()['{{ widget.name }}']);
        }
    });
    editor.set({'{{ widget.name }}': {{ widget.value|safe }}});
    editor.expandAll();
</script>